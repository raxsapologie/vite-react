<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>KRYNOS v3.0 - Intelligence Hub</title>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: #050505;
      color: #FFFFFF;
      overflow: hidden;
      height: 100vh;
      position: fixed;
      width: 100%;
    }

    /* SVG ICONS */
    .icon {
      display: inline-block;
      width: 20px;
      height: 20px;
      stroke: currentColor;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
      fill: none;
      flex-shrink: 0;
    }

    .icon-sm { width: 16px; height: 16px; }
    .icon-lg { width: 32px; height: 32px; }
    .icon-xl { width: 48px; height: 48px; stroke-width: 1.5; }

    .hidden { display: none !important; }

    /* AUTH SCREEN */
    .auth-screen {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #050505 0%, #0a0a0a 100%);
      padding: 20px;
    }

    .auth-container {
      background: #0D0D0E;
      padding: 40px 30px;
      border-radius: 20px;
      border: 1px solid #1F1F21;
      width: 100%;
      max-width: 380px;
      text-align: center;
      box-shadow: 0 8px 32px rgba(0, 242, 255, 0.1);
    }

    .auth-title {
      color: #FFFFFF;
      font-size: 24px;
      font-weight: 700;
      letter-spacing: 3px;
      margin: 24px 0 32px;
    }

    .input-group {
      margin-bottom: 16px;
      text-align: left;
    }

    .input-label {
      display: block;
      color: #888;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }

    .auth-input {
      width: 100%;
      padding: 14px 16px;
      background: #000000;
      border: 2px solid #222222;
      border-radius: 10px;
      color: #FFFFFF;
      font-size: 15px;
      transition: all 0.3s;
    }

    .auth-input:focus {
      outline: none;
      border-color: #00F2FF;
      box-shadow: 0 0 0 3px rgba(0, 242, 255, 0.1);
    }

    .auth-button {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #00F2FF 0%, #00D4E6 100%);
      border: none;
      border-radius: 10px;
      color: #000000;
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 2px;
      cursor: pointer;
      margin-top: 24px;
      transition: transform 0.2s;
    }

    .auth-button:active {
      transform: scale(0.98);
    }

    /* MOBILE MENU TOGGLE */
    .mobile-menu-toggle {
      display: none;
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1001;
      background: #0D0D0E;
      border: 1px solid #262629;
      border-radius: 10px;
      padding: 12px;
      cursor: pointer;
      color: #00F2FF;
    }

    /* DASHBOARD */
    .dashboard {
      display: flex;
      height: 100vh;
      width: 100vw;
    }

    /* SIDEBAR */
    .sidebar {
      width: 280px;
      background: #0D0D0E;
      border-right: 1px solid #1F1F21;
      display: flex;
      flex-direction: column;
      padding: 32px 20px;
      overflow-y: auto;
      transition: transform 0.3s;
    }

    .sidebar-header {
      display: flex;
      align-items: center;
      gap: 14px;
      margin-bottom: 48px;
      padding: 0 8px;
    }

    .sidebar-brand h1 {
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 2px;
      color: #FFFFFF;
    }

    .sidebar-brand span {
      font-size: 11px;
      color: #444444;
      font-weight: 500;
    }

    .nav-menu {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .nav-button {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 18px;
      background: transparent;
      border: 1px solid transparent;
      border-radius: 12px;
      color: #888888;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      text-align: left;
    }

    .nav-button:active {
      transform: scale(0.98);
    }

    .nav-button.active {
      background: #161618;
      border-color: #262629;
      color: #00F2FF;
    }

    .user-panel {
      padding: 18px;
      background: #161618;
      border: 1px solid #262629;
      border-radius: 12px;
      margin-bottom: 16px;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
    }

    .user-details h3 {
      font-size: 14px;
      font-weight: 700;
      color: #FFFFFF;
      margin-bottom: 2px;
    }

    .user-details p {
      font-size: 11px;
      color: #666666;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .online-users {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #262629;
    }

    .online-label {
      font-size: 10px;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 6px;
    }

    .online-user {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: #888;
      margin-bottom: 4px;
    }

    .online-dot {
      width: 6px;
      height: 6px;
      background: #00FF88;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    .logout-button {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 14px;
      background: transparent;
      border: 1px solid #262629;
      border-radius: 10px;
      color: #888888;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .logout-button:active {
      transform: scale(0.98);
    }

    /* MAIN CONTENT */
    .main-content {
      flex: 1;
      padding: 24px;
      overflow-y: auto;
      background: #050505;
      -webkit-overflow-scrolling: touch;
    }

    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
      flex-wrap: wrap;
      gap: 16px;
    }

    .page-title {
      font-size: 28px;
      font-weight: 700;
      color: #FFFFFF;
    }

    .btn {
      padding: 12px 20px;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }

    .btn:active {
      transform: scale(0.95);
    }

    .btn-primary {
      background: linear-gradient(135deg, #00F2FF 0%, #00D4E6 100%);
      color: #000000;
    }

    .btn-secondary {
      background: transparent;
      border: 1px solid #262629;
      color: #888888;
    }

    .btn-danger {
      background: transparent;
      border: none;
      color: #FF5050;
      padding: 8px;
    }

    .btn-upload {
      background: #161618;
      border: 1px solid #262629;
      color: #00F2FF;
      padding: 10px 18px;
      width: 100%;
      justify-content: center;
      margin-top: 12px;
    }

    /* STATS GRID */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .stat-card {
      background: linear-gradient(135deg, #161618 0%, #1a1a1c 100%);
      padding: 24px;
      border-radius: 16px;
      border: 1px solid #262629;
      transition: transform 0.2s;
    }

    .stat-card:active {
      transform: scale(0.98);
    }

    .stat-value {
      font-size: 36px;
      font-weight: 700;
      margin: 16px 0 8px;
    }

    .stat-label {
      color: #666666;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* LOGS */
    .logs-container {
      background: #161618;
      border: 1px solid #262629;
      border-radius: 16px;
      overflow: hidden;
    }

    .log-item {
      padding: 16px 20px;
      border-bottom: 1px solid #1F1F21;
      display: flex;
      gap: 16px;
      align-items: flex-start;
      font-size: 13px;
      flex-wrap: wrap;
    }

    .log-item:last-child {
      border-bottom: none;
    }

    .log-time {
      color: #444444;
      font-family: 'Courier New', monospace;
      font-size: 11px;
    }

    .log-user {
      color: #00F2FF;
      font-weight: 700;
    }

    .log-details {
      color: #CCCCCC;
      flex: 1;
    }

    /* PROJECTS */
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }

    .project-card {
      background: #161618;
      padding: 24px;
      border-radius: 16px;
      border: 1px solid #262629;
      transition: all 0.2s;
    }

    .project-card:active {
      transform: scale(0.98);
    }

    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 16px;
    }

    .project-name {
      font-size: 18px;
      font-weight: 700;
      color: #FFFFFF;
    }

    .project-desc {
      color: #888888;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 20px;
    }

    .progress-container {
      margin-bottom: 16px;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .progress-label {
      font-size: 11px;
      color: #666666;
      font-weight: 600;
      text-transform: uppercase;
    }

    .progress-value {
      font-size: 14px;
      font-weight: 700;
      color: #00F2FF;
    }

    .progress-bar {
      height: 6px;
      background: #050505;
      border-radius: 3px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #00F2FF 0%, #00D4E6 100%);
      transition: width 0.5s ease;
      border-radius: 3px;
    }

    /* TEAM */
    .team-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 20px;
    }

    .team-card {
      background: #161618;
      padding: 28px;
      border-radius: 16px;
      border: 1px solid #262629;
      text-align: center;
    }

    .status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin: 0 auto 16px;
    }

    .status-indicator.active {
      background: #00FF88;
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.6);
      animation: pulse 2s infinite;
    }

    .status-indicator.idle {
      background: #444444;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    .member-name {
      font-size: 16px;
      font-weight: 700;
      color: #FFFFFF;
      margin-bottom: 6px;
    }

    .member-role {
      font-size: 12px;
      color: #666666;
      margin-bottom: 20px;
    }

    /* TERMINAL */
    .terminal-container {
      background: #000000;
      border: 1px solid #262629;
      border-radius: 16px;
      padding: 20px;
      font-family: 'Courier New', monospace;
    }

    .terminal-output {
      height: 300px;
      overflow-y: auto;
      margin-bottom: 16px;
      color: #00FF88;
      font-size: 13px;
      line-height: 1.6;
    }

    .terminal-input-line {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .terminal-prompt {
      color: #00F2FF;
      font-weight: 700;
    }

    .terminal-input {
      flex: 1;
      background: transparent;
      border: none;
      color: #FFFFFF;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      outline: none;
    }

    /* MODAL */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      padding: 20px;
    }

    .modal-container {
      background: #0D0D0E;
      border: 1px solid #262629;
      border-radius: 20px;
      padding: 32px 24px;
      width: 100%;
      max-width: 480px;
      max-height: 90vh;
      overflow-y: auto;
    }

    .modal-title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 24px;
      color: #FFFFFF;
    }

    .form-group {
      margin-bottom: 18px;
    }

    .form-label {
      display: block;
      color: #888888;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }

    .form-input {
      width: 100%;
      padding: 12px 14px;
      background: #000000;
      border: 2px solid #222222;
      border-radius: 10px;
      color: #FFFFFF;
      font-size: 15px;
      transition: all 0.3s;
    }

    .form-input:focus {
      outline: none;
      border-color: #00F2FF;
    }

    .form-textarea {
      width: 100%;
      padding: 12px 14px;
      background: #000000;
      border: 2px solid #222222;
      border-radius: 10px;
      color: #FFFFFF;
      font-size: 15px;
      resize: vertical;
      min-height: 80px;
      font-family: inherit;
    }

    .form-textarea:focus {
      outline: none;
      border-color: #00F2FF;
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      margin-top: 24px;
    }

    .modal-actions .btn {
      flex: 1;
      justify-content: center;
    }

    /* SETTINGS */
    .settings-panel {
      max-width: 700px;
      background: #161618;
      padding: 28px;
      border-radius: 16px;
      border: 1px solid #262629;
    }

    /* STORAGE */
    .storage-section {
      margin-bottom: 32px;
    }

    .storage-header {
      font-size: 16px;
      font-weight: 700;
      color: #00F2FF;
      padding-bottom: 10px;
      border-bottom: 1px solid #262629;
      margin-bottom: 16px;
    }

    .files-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 12px;
    }

    .file-item {
      background: #161618;
      padding: 16px;
      border-radius: 12px;
      border: 1px solid #262629;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .file-info {
      flex: 1;
      min-width: 0;
    }

    .file-name {
      font-size: 13px;
      font-weight: 600;
      color: #FFFFFF;
      margin-bottom: 4px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .file-meta {
      font-size: 10px;
      color: #666666;
    }

    .file-actions {
      display: flex;
      gap: 6px;
      flex-shrink: 0;
    }

    /* SCROLLBAR */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #0D0D0E;
    }

    ::-webkit-scrollbar-thumb {
      background: #262629;
      border-radius: 3px;
    }

    /* MOBILE RESPONSIVE */
    @media (max-width: 768px) {
      .mobile-menu-toggle {
        display: block;
      }

      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        height: 100vh;
        z-index: 1000;
        transform: translateX(-100%);
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        padding: 80px 16px 16px;
      }

      .page-title {
        font-size: 24px;
      }

      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }

      .stat-card {
        padding: 16px;
      }

      .stat-value {
        font-size: 28px;
      }

      .projects-grid,
      .team-grid,
      .files-grid {
        grid-template-columns: 1fr;
      }

      .log-item {
        flex-direction: column;
        gap: 8px;
      }

      .modal-container {
        padding: 24px 20px;
      }

      .btn {
        padding: 10px 16px;
        font-size: 13px;
      }

      .terminal-output {
        height: 250px;
        font-size: 12px;
      }
    }

    @media (max-width: 480px) {
      .auth-container {
        padding: 32px 24px;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .page-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .sidebar {
        width: 260px;
      }
    }
  </style>
</head>
<body>
  <!-- MOBILE MENU TOGGLE -->
  <button class="mobile-menu-toggle" id="mobileMenuToggle" onclick="toggleMobileMenu()">
    <svg class="icon" viewBox="0 0 24 24">
      <line x1="3" y1="12" x2="21" y2="12"/>
      <line x1="3" y1="6" x2="21" y2="6"/>
      <line x1="3" y1="18" x2="21" y2="18"/>
    </svg>
  </button>

  <!-- AUTH SCREEN -->
  <div id="authScreen" class="auth-screen">
    <div class="auth-container">
      <svg class="icon icon-xl" style="color: #00F2FF; margin: 0 auto; filter: drop-shadow(0 0 20px rgba(0, 242, 255, 0.5));" viewBox="0 0 24 24">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
      </svg>
      <h1 class="auth-title">KRYNOS AUTH</h1>
      <form id="loginForm">
        <div class="input-group">
          <label class="input-label">Username</label>
          <input type="text" id="loginUsername" class="auth-input" required autocomplete="username">
        </div>
        <div class="input-group">
          <label class="input-label">Passkey</label>
          <input type="password" id="loginPassword" class="auth-input" required autocomplete="current-password">
        </div>
        <button type="submit" class="auth-button">ENTER SYSTEM</button>
      </form>
    </div>
  </div>

  <!-- MAIN DASHBOARD -->
  <div id="dashboardScreen" class="dashboard hidden">
    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <svg class="icon icon-lg" style="color: #00F2FF; filter: drop-shadow(0 0 12px rgba(0, 242, 255, 0.5));" viewBox="0 0 24 24">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
        </svg>
        <div class="sidebar-brand">
          <h1>KRYNOS</h1>
          <span>v3.0 MULTIPLAYER</span>
        </div>
      </div>

      <nav class="nav-menu" id="navMenu">
        <button class="nav-button active" data-page="dashboard">
          <svg class="icon" viewBox="0 0 24 24">
            <rect x="3" y="3" width="7" height="7" rx="1"/>
            <rect x="14" y="3" width="7" height="7" rx="1"/>
            <rect x="14" y="14" width="7" height="7" rx="1"/>
            <rect x="3" y="14" width="7" height="7" rx="1"/>
          </svg>
          <span>Dashboard</span>
        </button>
        <button class="nav-button" data-page="projects">
          <svg class="icon" viewBox="0 0 24 24">
            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
          </svg>
          <span>Projects</span>
        </button>
        <button class="nav-button" data-page="team">
          <svg class="icon" viewBox="0 0 24 24">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
            <circle cx="9" cy="7" r="4"/>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
          </svg>
          <span>Team</span>
        </button>
        <button class="nav-button" data-page="storage">
          <svg class="icon" viewBox="0 0 24 24">
            <ellipse cx="12" cy="5" rx="9" ry="3"/>
            <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/>
            <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>
          </svg>
          <span>Storage</span>
        </button>
        <button class="nav-button" data-page="security">
          <svg class="icon" viewBox="0 0 24 24">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
          <span>Security</span>
        </button>
        <button class="nav-button" data-page="terminal">
          <svg class="icon" viewBox="0 0 24 24">
            <polyline points="4 17 10 11 4 5"/>
            <line x1="12" y1="19" x2="20" y2="19"/>
          </svg>
          <span>Terminal</span>
        </button>
        <button class="nav-button" data-page="settings">
          <svg class="icon" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v6m0 6v6m8.66-13.66l-4.24 4.24m-4.24 4.24l-4.24 4.24M1 12h6m6 0h6M3.34 3.34l4.24 4.24m4.24 4.24l4.24 4.24"/>
          </svg>
          <span>Settings</span>
        </button>
      </nav>

      <div class="user-panel">
        <div class="user-info">
          <svg class="icon" viewBox="0 0 24 24" style="color: #00F2FF;">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
            <circle cx="12" cy="7" r="4"/>
          </svg>
          <div class="user-details">
            <h3 id="displayUsername">User</h3>
            <p>Operative</p>
          </div>
        </div>
        <div class="online-users">
          <div class="online-label">Online Now</div>
          <div id="onlineUsersList"></div>
        </div>
      </div>

      <button class="logout-button" id="logoutBtn">
        <svg class="icon" viewBox="0 0 24 24">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <polyline points="16 17 21 12 16 7"/>
          <line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
        <span>Logout</span>
      </button>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main-content">
      <!-- DASHBOARD PAGE -->
      <div id="page-dashboard" class="page-content">
        <div class="page-header">
          <h1 class="page-title">Dashboard</h1>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <svg class="icon-lg" style="color: #00F2FF;" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-width="2" d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
            </svg>
            <div class="stat-value" id="statProjects">0</div>
            <div class="stat-label">Projects</div>
          </div>
          <div class="stat-card">
            <svg class="icon-lg" style="color: #00FF88;" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-width="2" d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
              <circle stroke="currentColor" stroke-width="2" cx="9" cy="7" r="4"/>
            </svg>
            <div class="stat-value" id="statTeam" style="color: #00FF88;">0</div>
            <div class="stat-label">Team Active</div>
          </div>
          <div class="stat-card">
            <svg class="icon-lg" style="color: #FF5050;" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-width="2" d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"/>
              <polyline stroke="currentColor" stroke-width="2" points="13 2 13 9 20 9"/>
            </svg>
            <div class="stat-value" id="statFiles">0</div>
            <div class="stat-label">Files</div>
          </div>
          <div class="stat-card">
            <svg class="icon-lg" style="color: #FFB800;" viewBox="0 0 24 24">
              <polyline stroke="currentColor" stroke-width="2" points="22 12 18 12 15 21 9 3 6 12 2 12"/>
            </svg>
            <div class="stat-value" id="statLogs">0</div>
            <div class="stat-label">Activity</div>
          </div>
        </div>

        <div style="margin-bottom: 32px;">
          <h2 style="font-size: 20px; font-weight: 700; color: #00F2FF; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
            <svg class="icon" viewBox="0 0 24 24">
              <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
            </svg>
            <span>Live Activity</span>
          </h2>
          <div class="logs-container" id="dashboardLogs"></div>
        </div>
      </div>

      <!-- PROJECTS PAGE -->
      <div id="page-projects" class="page-content hidden">
        <div class="page-header">
          <h1 class="page-title">Projects</h1>
          <button class="btn btn-primary" id="btnNewProject">
            <svg class="icon icon-sm" viewBox="0 0 24 24">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            <span>New</span>
          </button>
        </div>
        <div class="projects-grid" id="projectsContainer"></div>
      </div>

      <!-- TEAM PAGE -->
      <div id="page-team" class="page-content hidden">
        <div class="page-header">
          <h1 class="page-title">Team</h1>
          <button class="btn btn-primary" id="btnNewMember">
            <svg class="icon icon-sm" viewBox="0 0 24 24">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            <span>Add</span>
          </button>
        </div>
        <div class="team-grid" id="teamContainer"></div>
      </div>

      <!-- STORAGE PAGE -->
      <div id="page-storage" class="page-content hidden">
        <div class="page-header">
          <h1 class="page-title">Storage</h1>
        </div>
        <div id="storageContainer"></div>
      </div>

      <!-- SECURITY PAGE -->
      <div id="page-security" class="page-content hidden">
        <div class="page-header">
          <h1 class="page-title">Security</h1>
        </div>
        <div class="logs-container" id="securityLogs"></div>
      </div>

      <!-- TERMINAL PAGE -->
      <div id="page-terminal" class="page-content hidden">
        <div class="page-header">
          <h1 class="page-title">Terminal</h1>
        </div>
        <div class="terminal-container">
          <div class="terminal-output" id="terminalOutput">
            <div>> KRYNOS Intelligence Hub Online</div>
            <div>> Type "help" for commands</div>
          </div>
          <div class="terminal-input-line">
            <span class="terminal-prompt">$</span>
            <input type="text" class="terminal-input" id="terminalInput" autocomplete="off">
          </div>
        </div>
      </div>

      <!-- SETTINGS PAGE -->
      <div id="page-settings" class="page-content hidden">
        <div class="page-header">
          <h1 class="page-title">Settings</h1>
        </div>
        <div class="settings-panel">
          <div class="form-group">
            <label class="form-label">Discord Webhook</label>
            <input type="password" class="form-input" id="webhookInput" placeholder="https://discord.com/api/webhooks/...">
          </div>
          <button class="btn btn-secondary" id="btnTestWebhook">
            <svg class="icon icon-sm" viewBox="0 0 24 24">
              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
            </svg>
            <span>Test</span>
          </button>
        </div>
      </div>
    </main>
  </div>

  <!-- MODALS -->
  <div id="modalProject" class="modal-overlay hidden">
    <div class="modal-container">
      <h2 class="modal-title">New Project</h2>
      <form id="formProject">
        <div class="form-group">
          <label class="form-label">Project Name</label>
          <input type="text" class="form-input" id="projectName" required>
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-textarea" id="projectDesc" required></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Progress (%)</label>
          <input type="number" class="form-input" id="projectProgress" min="0" max="100" value="0">
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn btn-primary">Launch</button>
          <button type="button" class="btn btn-secondary" id="btnCancelProject">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalTeam" class="modal-overlay hidden">
    <div class="modal-container">
      <h2 class="modal-title">Add Member</h2>
      <form id="formTeam">
        <div class="form-group">
          <label class="form-label">Name</label>
          <input type="text" class="form-input" id="memberName" required>
        </div>
        <div class="form-group">
          <label class="form-label">Role</label>
          <input type="text" class="form-input" id="memberRole" required>
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn btn-primary">Add</button>
          <button type="button" class="btn btn-secondary" id="btnCancelTeam">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // ===== FIREBASE CONFIG =====
    const firebaseConfig = {
      apiKey: "AIzaSyAobw7KFnEomHmL2X925kuL6KDyeiaOJu0",
      authDomain: "krynos-fe88b.firebaseapp.com",
      databaseURL: "https://krynos-fe88b-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "krynos-fe88b",
      storageBucket: "krynos-fe88b.firebasestorage.app",
      messagingSenderId: "866179490178",
      appId: "1:866179490178:web:5c4ff4a524c0454de0af9b"
    };

    // Initialize Firebase
    let database = null;
    let isFirebaseConfigured = false;

    try {
      // His Firebase is now configured!
      firebase.initializeApp(firebaseConfig);
      database = firebase.database();
      isFirebaseConfigured = true;
      console.log('✅ Firebase initialized - Multiplayer ACTIVE');
    } catch (e) {
      console.error('Firebase initialization error:', e);
    }

    // ===== STATE =====
    const APP = {
      currentUser: null,
      currentPage: 'dashboard',
      userId: null,
      presenceRef: null
    };

    // ===== MOBILE MENU =====
    function toggleMobileMenu() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('open');
    }

    // Close mobile menu when clicking nav items
    document.addEventListener('click', (e) => {
      const sidebar = document.getElementById('sidebar');
      const toggle = document.getElementById('mobileMenuToggle');
      if (sidebar.classList.contains('open') && !sidebar.contains(e.target) && !toggle.contains(e.target)) {
        sidebar.classList.remove('open');
      }
    });

    // ===== FIREBASE SYNC =====
    const FirebaseSync = {
      init(username) {
        if (!isFirebaseConfigured) return;

        APP.userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

        // Presence system
        APP.presenceRef = database.ref('presence/' + APP.userId);
        APP.presenceRef.set({
          username: username,
          online: true,
          lastSeen: firebase.database.ServerValue.TIMESTAMP
        });

        APP.presenceRef.onDisconnect().remove();

        // Listen to online users
        database.ref('presence').on('value', (snapshot) => {
          const users = [];
          snapshot.forEach((child) => {
            const user = child.val();
            if (user.online && user.username !== username) {
              users.push(user.username);
            }
          });
          this.renderOnlineUsers(users);
        });

        // Sync data
        this.syncProjects();
        this.syncTeam();
        this.syncFiles();
        this.syncLogs();
        this.syncWebhook();
      },

      renderOnlineUsers(users) {
        const container = document.getElementById('onlineUsersList');
        if (!container) return;
        
        if (users.length === 0) {
          container.innerHTML = '<div style="font-size: 11px; color: #444;">No one else online</div>';
        } else {
          container.innerHTML = users.map(u => `
            <div class="online-user">
              <div class="online-dot"></div>
              <span>${u}</span>
            </div>
          `).join('');
        }
      },

      syncProjects() {
        database.ref('projects').on('value', (snapshot) => {
          const projects = [];
          snapshot.forEach((child) => {
            projects.push({ id: child.key, ...child.val() });
          });
          UI.renderProjectsFromFirebase(projects);
        });
      },

      syncTeam() {
        database.ref('team').on('value', (snapshot) => {
          const team = [];
          snapshot.forEach((child) => {
            team.push({ id: child.key, ...child.val() });
          });
          UI.renderTeamFromFirebase(team);
        });
      },

      syncFiles() {
        database.ref('files').on('value', (snapshot) => {
          const files = [];
          snapshot.forEach((child) => {
            files.push({ id: child.key, ...child.val() });
          });
          UI.renderStorageFromFirebase(files);
        });
      },

      syncLogs() {
        database.ref('logs').limitToLast(100).on('value', (snapshot) => {
          const logs = [];
          snapshot.forEach((child) => {
            logs.push({ id: child.key, ...child.val() });
          });
          UI.renderLogsFromFirebase(logs.reverse());
        });
      },

      syncWebhook() {
        database.ref('settings/webhook').on('value', (snapshot) => {
          const webhook = snapshot.val() || '';
          const input = document.getElementById('webhookInput');
          if (input) input.value = webhook;
        });
      },

      addProject(project) {
        if (!isFirebaseConfigured) return;
        database.ref('projects').push(project);
      },

      deleteProject(id) {
        if (!isFirebaseConfigured) return;
        database.ref('projects/' + id).remove();
        // Delete associated files
        database.ref('files').orderByChild('projectId').equalTo(id).once('value', (snapshot) => {
          snapshot.forEach((child) => {
            child.ref.remove();
          });
        });
      },

      uploadFile(file) {
        if (!isFirebaseConfigured) return;
        database.ref('files').push(file);
      },

      deleteFile(id) {
        if (!isFirebaseConfigured) return;
        database.ref('files/' + id).remove();
      },

      addTeamMember(member) {
        if (!isFirebaseConfigured) return;
        database.ref('team').push(member);
      },

      updateTeamStatus(id, status) {
        if (!isFirebaseConfigured) return;
        database.ref('team/' + id).update({ status });
      },

      addLog(log) {
        if (!isFirebaseConfigured) return;
        database.ref('logs').push(log);
      },

      updateWebhook(webhook) {
        if (!isFirebaseConfigured) return;
        database.ref('settings/webhook').set(webhook);
      },

      cleanup() {
        if (APP.presenceRef) {
          APP.presenceRef.remove();
        }
      }
    };

    // ===== DISCORD =====
    const Discord = {
      async send(title, message, color = 0x00F2FF) {
        const webhook = document.getElementById('webhookInput')?.value;
        if (!webhook) return;
        try {
          await fetch(webhook, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              embeds: [{
                title: `[KRYNOS] ${title}`,
                description: `${message}\n**Operative:** ${APP.currentUser?.name || 'System'}`,
                color: color,
                timestamp: new Date().toISOString()
              }]
            })
          });
        } catch (e) {
          console.error('Discord error:', e);
        }
      }
    };

    // ===== UI =====
    const UI = {
      showAuth() {
        document.getElementById('authScreen').classList.remove('hidden');
        document.getElementById('dashboardScreen').classList.add('hidden');
        document.getElementById('mobileMenuToggle').classList.add('hidden');
      },

      showDashboard() {
        document.getElementById('authScreen').classList.add('hidden');
        document.getElementById('dashboardScreen').classList.remove('hidden');
        document.getElementById('mobileMenuToggle').classList.remove('hidden');
        document.getElementById('displayUsername').textContent = APP.currentUser.name;
        this.navigateTo('dashboard');
      },

      navigateTo(page) {
        document.querySelectorAll('.nav-button').forEach(btn => {
          btn.classList.remove('active');
          if (btn.dataset.page === page) btn.classList.add('active');
        });

        document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
        const pageEl = document.getElementById(`page-${page}`);
        if (pageEl) {
          pageEl.classList.remove('hidden');
          APP.currentPage = page;
          
          // Trigger render for current page
          if (!isFirebaseConfigured) {
            this.renderPageFallback(page);
          }
        }

        // Close mobile menu after navigation
        if (window.innerWidth <= 768) {
          document.getElementById('sidebar').classList.remove('open');
        }
      },

      renderPageFallback(page) {
        // Fallback rendering when Firebase is not configured
        switch(page) {
          case 'projects':
            const projContainer = document.getElementById('projectsContainer');
            if (projContainer) {
              projContainer.innerHTML = '<div style="padding: 40px; text-align: center; color: #666;"><p style="margin-bottom: 16px;">Firebase not configured</p><p style="font-size: 13px;">Configure Firebase to enable multiplayer sync</p></div>';
            }
            break;
          case 'team':
            const teamContainer = document.getElementById('teamContainer');
            if (teamContainer) {
              teamContainer.innerHTML = '<div style="padding: 40px; text-align: center; color: #666;"><p style="margin-bottom: 16px;">Firebase not configured</p><p style="font-size: 13px;">Configure Firebase to enable multiplayer sync</p></div>';
            }
            break;
          case 'storage':
            const storageContainer = document.getElementById('storageContainer');
            if (storageContainer) {
              storageContainer.innerHTML = '<div style="padding: 40px; text-align: center; color: #666;"><p style="margin-bottom: 16px;">Firebase not configured</p><p style="font-size: 13px;">Configure Firebase to enable multiplayer sync</p></div>';
            }
            break;
          case 'security':
            const secContainer = document.getElementById('securityLogs');
            if (secContainer) {
              secContainer.innerHTML = '<div class="log-item"><span class="log-details">Firebase not configured - Enable Firebase to see security logs</span></div>';
            }
            break;
        }
      },

      renderProjectsFromFirebase(projects) {
        const container = document.getElementById('projectsContainer');
        if (!container) return;
        
        try {
          document.getElementById('statProjects').textContent = projects.length;
        } catch(e) {}
        
        const html = projects.map(p => `
          <div class="project-card">
            <div class="project-header">
              <h3 class="project-name">${p.name || 'Unnamed'}</h3>
              <button class="btn-danger" onclick="Projects.delete('${p.id}')">
                <svg class="icon icon-sm" viewBox="0 0 24 24">
                  <polyline points="3 6 5 6 21 6"/>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                </svg>
              </button>
            </div>
            <p class="project-desc">${p.desc || ''}</p>
            <div class="progress-container">
              <div class="progress-header">
                <span class="progress-label">Progress</span>
                <span class="progress-value">${p.progress || 0}%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: ${p.progress || 0}%"></div>
              </div>
            </div>
            <label class="btn btn-upload">
              <svg class="icon icon-sm" viewBox="0 0 24 24">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17 8 12 3 7 8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
              </svg>
              <span>Upload</span>
              <input type="file" multiple hidden onchange="Projects.uploadFiles(event, '${p.id}', '${(p.name || 'Project').replace(/'/g, "\\'")}')">
            </label>
          </div>
        `).join('');
        
        container.innerHTML = html || '<p style="color: #666; padding: 40px; text-align: center;">No projects yet. Click "New" to create one.</p>';
      },

      renderTeamFromFirebase(team) {
        const container = document.getElementById('teamContainer');
        if (!container) return;
        
        const activeCount = team.filter(m => m.status === 'active').length;
        document.getElementById('statTeam').textContent = activeCount;
        
        const html = team.map(m => `
          <div class="team-card">
            <div class="status-indicator ${m.status}"></div>
            <h3 class="member-name">${m.name}</h3>
            <p class="member-role">${m.role}</p>
            <button class="btn btn-secondary" onclick="Team.toggleStatus('${m.id}', '${m.status}', '${m.name}')">
              ${m.status === 'active' ? 'Set Idle' : 'Set Active'}
            </button>
          </div>
        `).join('');
        
        container.innerHTML = html || '<p style="color: #666;">No team members</p>';
      },

      renderStorageFromFirebase(files) {
        const container = document.getElementById('storageContainer');
        if (!container) return;
        
        document.getElementById('statFiles').textContent = files.length;
        
        // Group files by project
        database.ref('projects').once('value', (snapshot) => {
          const projects = [];
          snapshot.forEach((child) => {
            projects.push({ id: child.key, ...child.val() });
          });

          const html = projects.map(proj => {
            const projFiles = files.filter(f => f.projectId === proj.id);
            if (projFiles.length === 0) return '';
            
            return `
              <div class="storage-section">
                <h3 class="storage-header">${proj.name}</h3>
                <div class="files-grid">
                  ${projFiles.map(f => `
                    <div class="file-item">
                      <svg class="icon" style="color: #00F2FF;" viewBox="0 0 24 24">
                        <path stroke="currentColor" stroke-width="2" d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"/>
                        <polyline stroke="currentColor" stroke-width="2" points="13 2 13 9 20 9"/>
                      </svg>
                      <div class="file-info">
                        <div class="file-name">${f.name}</div>
                        <div class="file-meta">${f.uploader} • ${f.size}</div>
                      </div>
                      <div class="file-actions">
                        <button class="btn-danger" onclick="Files.download('${f.id}', '${f.name}', '${f.data}')">
                          <svg class="icon icon-sm" viewBox="0 0 24 24">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                          </svg>
                        </button>
                        <button class="btn-danger" onclick="Files.delete('${f.id}', '${f.name}')">
                          <svg class="icon icon-sm" viewBox="0 0 24 24">
                            <polyline points="3 6 5 6 21 6"/>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/>
                          </svg>
                        </button>
                      </div>
                    </div>
                  `).join('')}
                </div>
              </div>
            `;
          }).filter(Boolean).join('');
          
          container.innerHTML = html || '<p style="color: #666;">No files uploaded</p>';
        });
      },

      renderLogsFromFirebase(logs) {
        document.getElementById('statLogs').textContent = logs.length;
        
        const dashContainer = document.getElementById('dashboardLogs');
        if (dashContainer) {
          const html = logs.slice(0, 8).map(log => `
            <div class="log-item">
              <span class="log-time">${new Date(log.timestamp).toLocaleString()}</span>
              <span class="log-user">${log.user}</span>
              <span class="log-details">${log.details}</span>
            </div>
          `).join('');
          dashContainer.innerHTML = html || '<div class="log-item"><span class="log-details">No activity</span></div>';
        }

        const secContainer = document.getElementById('securityLogs');
        if (secContainer && APP.currentPage === 'security') {
          const html = logs.map(log => `
            <div class="log-item">
              <span class="log-time">${new Date(log.timestamp).toLocaleString()}</span>
              <span class="log-user">${log.user}</span>
              <span class="log-details">${log.details}</span>
            </div>
          `).join('');
          secContainer.innerHTML = html || '<div class="log-item"><span class="log-details">No logs</span></div>';
        }
      },

      openModal(id) {
        document.getElementById(id).classList.remove('hidden');
      },

      closeModal(id) {
        document.getElementById(id).classList.add('hidden');
      }
    };

    // ===== AUTH =====
    const Auth = {
      login(username, password) {
        if (!username || !password) {
          alert('Enter username and password');
          return;
        }

        if (password !== 'krynos2026') {
          alert('ACCESS DENIED');
          return;
        }

        APP.currentUser = { name: username };
        
        if (isFirebaseConfigured) {
          FirebaseSync.init(username);
          FirebaseSync.addLog({
            timestamp: Date.now(),
            user: username,
            details: username + ' logged in'
          });
        }

        Discord.send('SECURITY', `**${username}** logged in`, 0x00FF88);
        UI.showDashboard();
      },

      logout() {
        if (isFirebaseConfigured && APP.currentUser) {
          FirebaseSync.addLog({
            timestamp: Date.now(),
            user: APP.currentUser.name,
            details: APP.currentUser.name + ' logged out'
          });
          FirebaseSync.cleanup();
        }
        
        APP.currentUser = null;
        UI.showAuth();
      }
    };

    // ===== PROJECTS =====
    const Projects = {
      create(name, desc, progress) {
        const project = { name, desc, progress: parseInt(progress) || 0 };
        
        if (isFirebaseConfigured) {
          FirebaseSync.addProject(project);
          FirebaseSync.addLog({
            timestamp: Date.now(),
            user: APP.currentUser.name,
            details: `Project "${name}" created`
          });
        } else {
          alert('Firebase not configured. Enable Firebase to sync with your team.');
        }
        
        Discord.send('PROJECT', `**${name}** created`, 0x00F2FF);
      },

      delete(id) {
        if (!isFirebaseConfigured || !database) {
          alert('Firebase not configured');
          return;
        }
        
        database.ref('projects/' + id).once('value', (snapshot) => {
          const project = snapshot.val();
          if (project && confirm(`Delete "${project.name}"?`)) {
            FirebaseSync.deleteProject(id);
            FirebaseSync.addLog({
              timestamp: Date.now(),
              user: APP.currentUser.name,
              details: `Project "${project.name}" deleted`
            });
            Discord.send('PROJECT', `**${project.name}** deleted`, 0xFF5050);
          }
        });
      },

      uploadFiles(event, projectId, projectName) {
        const files = event.target.files;
        if (!files.length) return;

        if (!isFirebaseConfigured) {
          alert('Firebase not configured. Enable Firebase to upload files.');
          return;
        }

        Array.from(files).forEach(file => {
          const reader = new FileReader();
          reader.onload = (e) => {
            const fileData = {
              name: file.name,
              size: (file.size / 1024).toFixed(1) + ' KB',
              data: e.target.result,
              projectId: projectId,
              uploader: APP.currentUser.name,
              timestamp: Date.now()
            };
            
            FirebaseSync.uploadFile(fileData);
            FirebaseSync.addLog({
              timestamp: Date.now(),
              user: APP.currentUser.name,
              details: `"${file.name}" uploaded to "${projectName}"`
            });
            
            Discord.send('FILE', `**${APP.currentUser.name}** uploaded **${file.name}**`, 0x00FFD4);
          };
          reader.readAsDataURL(file);
        });
      }
    };

    // ===== TEAM =====
    const Team = {
      add(name, role) {
        const member = { name, role, status: 'active' };
        
        if (isFirebaseConfigured) {
          FirebaseSync.addTeamMember(member);
          FirebaseSync.addLog({
            timestamp: Date.now(),
            user: APP.currentUser.name,
            details: `${name} added as ${role}`
          });
        }
        
        Discord.send('TEAM', `**${name}** joined as ${role}`, 0x00FF88);
      },

      toggleStatus(id, currentStatus, name) {
        const newStatus = currentStatus === 'active' ? 'idle' : 'active';
        
        if (isFirebaseConfigured) {
          FirebaseSync.updateTeamStatus(id, newStatus);
          FirebaseSync.addLog({
            timestamp: Date.now(),
            user: APP.currentUser.name,
            details: `${name} status: ${newStatus}`
          });
        }
        
        Discord.send('TEAM', `**${name}** is now **${newStatus}**`, 0xFFB800);
      }
    };

    // ===== FILES =====
    const Files = {
      download(id, name, data) {
        const a = document.createElement('a');
        a.href = data;
        a.download = name;
        a.click();
        
        if (isFirebaseConfigured) {
          FirebaseSync.addLog({
            timestamp: Date.now(),
            user: APP.currentUser.name,
            details: `"${name}" downloaded`
          });
        }
      },

      delete(id, name) {
        if (confirm(`Delete "${name}"?`)) {
          if (isFirebaseConfigured) {
            FirebaseSync.deleteFile(id);
            FirebaseSync.addLog({
              timestamp: Date.now(),
              user: APP.currentUser.name,
              details: `"${name}" deleted`
            });
          }
        }
      }
    };

    // ===== TERMINAL =====
    const Terminal = {
      execute(command) {
        const output = document.getElementById('terminalOutput');
        output.innerHTML += `<div style="color: #FFF;">> ${command}</div>`;
        
        const cmd = command.toLowerCase().trim();
        
        if (cmd === 'help') {
          output.innerHTML += `<div>status, clear, alert [msg], info</div>`;
        } else if (cmd === 'status') {
          output.innerHTML += `<div>SYSTEM ONLINE | Multiplayer: ${isFirebaseConfigured ? 'ACTIVE' : 'DISABLED'}</div>`;
        } else if (cmd === 'clear') {
          output.innerHTML = '<div>> Terminal cleared</div>';
        } else if (cmd.startsWith('alert ')) {
          const message = command.substring(6);
          Discord.send('ALERT', message, 0xFF5050);
          output.innerHTML += `<div style="color: #FFB800;">Alert sent: ${message}</div>`;
        } else if (cmd === 'info') {
          output.innerHTML += `<div>KRYNOS v3.0 | User: ${APP.currentUser.name}</div>`;
        } else {
          output.innerHTML += `<div style="color: #FF5050;">Unknown: ${command}</div>`;
        }
        
        if (isFirebaseConfigured) {
          FirebaseSync.addLog({
            timestamp: Date.now(),
            user: APP.currentUser.name,
            details: `Command: ${command}`
          });
        }
        
        output.scrollTop = output.scrollHeight;
      }
    };

    // ===== SETTINGS =====
    const Settings = {
      async testWebhook() {
        const webhook = document.getElementById('webhookInput').value;
        if (!webhook) {
          alert('Enter webhook URL first');
          return;
        }
        
        if (isFirebaseConfigured) {
          FirebaseSync.updateWebhook(webhook);
        }
        
        await Discord.send('TEST', 'Connection test successful', 0x00FF88);
        alert('Test sent! Check Discord.');
      }
    };

    // ===== EVENT LISTENERS =====
    function initEvents() {
      document.getElementById('loginForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const username = document.getElementById('loginUsername').value;
        const password = document.getElementById('loginPassword').value;
        Auth.login(username, password);
      });

      document.getElementById('logoutBtn').addEventListener('click', () => Auth.logout());

      document.querySelectorAll('.nav-button').forEach(btn => {
        btn.addEventListener('click', () => {
          const page = btn.dataset.page;
          if (page) UI.navigateTo(page);
        });
      });

      document.getElementById('btnNewProject').addEventListener('click', () => UI.openModal('modalProject'));
      document.getElementById('btnCancelProject').addEventListener('click', () => UI.closeModal('modalProject'));
      document.getElementById('formProject').addEventListener('submit', (e) => {
        e.preventDefault();
        const name = document.getElementById('projectName').value;
        const desc = document.getElementById('projectDesc').value;
        const progress = document.getElementById('projectProgress').value;
        Projects.create(name, desc, progress);
        UI.closeModal('modalProject');
        e.target.reset();
      });

      document.getElementById('btnNewMember').addEventListener('click', () => UI.openModal('modalTeam'));
      document.getElementById('btnCancelTeam').addEventListener('click', () => UI.closeModal('modalTeam'));
      document.getElementById('formTeam').addEventListener('submit', (e) => {
        e.preventDefault();
        const name = document.getElementById('memberName').value;
        const role = document.getElementById('memberRole').value;
        Team.add(name, role);
        UI.closeModal('modalTeam');
        e.target.reset();
      });

      document.getElementById('terminalInput').addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && e.target.value.trim()) {
          Terminal.execute(e.target.value);
          e.target.value = '';
        }
      });

      document.getElementById('btnTestWebhook').addEventListener('click', () => Settings.testWebhook());

      document.getElementById('webhookInput').addEventListener('change', (e) => {
        if (isFirebaseConfigured) {
          FirebaseSync.updateWebhook(e.target.value);
        }
      });
    }

    // ===== INIT =====
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initEvents);
    } else {
      initEvents();
    }

    // Cleanup on page unload
    window.addEventListener('beforeunload', () => {
      if (isFirebaseConfigured) {
        FirebaseSync.cleanup();
      }
    });
  </script>
</body>
</html>
